<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>HTML5 Slides - Infinite Gag</title>
<link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;500;700&display=swap" rel="stylesheet">

<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { width: 100%; height: 100%; overflow: hidden; background: #111; color: #fff; font-family: 'Raleway', sans-serif; }

  .slides { width: 100%; height: 100%; position: relative; overflow: hidden; }
  .slide { width: 100%; height: 100%; position: absolute; top: 0; display: flex; flex-direction: column; justify-content: center; padding: 4rem; transition: transform 0.6s ease; }

  .content-box { max-width: 50%; z-index: 2; }
  .content-box h2 { font-size: 1rem; opacity: 0.6; text-align: left; text-transform: uppercase; letter-spacing: 2px;}
  .content-box h1 { font-size: 2rem; margin-top: 0.5rem; text-align: left; }
  .content-box h3 { font-size: 1.2rem; opacity: 0.9; margin-top: 0.3rem; text-align: left; }
  .content-box p { font-size: 1rem; margin-top: 1rem; opacity: 0.85; line-height: 1.4; text-align: left; }
  
  /* Style spécifique pour les citations académiques (User Preference) */
  .quote-ref { font-variant: small-caps; font-size: 0.8rem; margin-top: 2rem; border-top: 1px solid #444; padding-top: 0.5rem; display: inline-block;}

  .image-box { 
    position: absolute; 
    right: 0; top: 0; 
    width: 55%; height: 100%; 
    background-size: cover; background-position: center; 
    opacity: 0.8; 
    z-index: 1; 
  }

  /* Bullet list slide style */
  .bullet-list li { opacity: 0; transition: opacity 0.4s ease; font-size: 1.4rem; margin: 1rem 0; }
  
  .fullscreen-button {
    position: fixed; top: 15px; right: 15px; z-index: 100;
    cursor: pointer; background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2); color: #fff;
    padding: 5px 12px; border-radius: 4px; font-size: 0.8rem;
    transition: opacity 0.3s ease, background 0.3s ease; opacity: 0.5;
  }
  .fullscreen-button:hover { opacity: 1; background: rgba(255, 255, 255, 0.2); }
</style>
</head>

<body>
<div class="slides" id="slides">

  <section class="slide" style="background:#111;">
    <div class="content-box">
      <h2>Préhistoire et Anticipation</h2>
      <h1>La Préhistoire dessine-t-elle les limites <br>du récit spéculatif ?</h1>
      <h3>Benjamin Efrati - Doctorant CRAL - EHESS/CNRS</h3>
      <p>Time World - 4.12.2025 - Besançon</p>
    </div>
    <span class="image-box" style="background-image:url('https://github.com/gnozo/slides/blob/main/img/Lascaux1.jpg?raw=true');"></span>
  </section>

  <section class="slide" style="background:#111;">
    <div class="content-box">
      <h2>Préhistoire et Anticipation</h2>
      <h1>Contexte Historique</h1>
      <h3>Retour au XIXe siècle</h3>
      <p>Avec l'émergence de l'archéologie préhistorique, les "curiosités antédiluviennes" nous ont donné accès à un imaginaire du temps profond.</p>
      <p>Ce dernier s'impose d'abord comme une alternative à l'imaginaire biblique, mais il reste chargé d'allusions aux prophéties apoicalyptiques et catastrophes créationnistes.</p>
    </div>
    <span class="image-box" style="background-image:url('https://github.com/gnozo/slides/blob/main/img/silos.jpg?raw=true');"></span>
  </section>

  <section class="slide" style="background:#111;">
    <div class="content-box">
      <h2>1.1</h2>
      <h1>Échos d'Horizon</h1>
      <h3>Fragments d’un futur discret</h3>
      <p>Dans un monde flottant entre certitude et mirage, les mots se tissent en réseaux fluides.</p>
    </div>
    <span class="image-box" style="background-image:url('https://github.com/gnozo/slides/blob/main/img/daniel.gif?raw=true');"></span>
  </section>

  <section class="slide gag-slide" style="background:#111;">
    <div class="content-box">
      <h2>Analyse Systémique</h2>
      <h1>Points Essentiels</h1>
      <ul class="bullet-list"></ul>
      <p style="margin-top:2rem; opacity:0.5; font-size:0.8rem; border-top:1px solid #333; padding-top:0.5rem;">
        → Ajouter point : Flèche Droite / Bas <br>
        ↑ Sortir de la boucle et continuer la conférence
      </p>
    </div>
  </section>

</div>

<button id="fullscreenToggle" class="fullscreen-button">Plein Écran</button>

<script>
// --- CONFIGURATION ---
const IMG_GITHUB = 'https://github.com/gnozo/slides/blob/main/img/Lascaux1.jpg?raw=true';
const BATCH_SIZE = 10; // Nombre de diapos générées après la liste
let globalSlideCounter = 1; // Pour les titres incrémentiels

// --- ETAT GLOBAL ---
let slides = Array.from(document.querySelectorAll('.slide'));
let index = 0;

// Phrases aléatoires pour le "Bullshit Bingo" des puces
const randomBullets = [
  "Le réseau révèle l’invisible.",
  "La structure donne sens au mouvement.",
  "Les systèmes émergent du chaos.",
  "La perception façonne la réalité.",
  "Synergie des vecteurs cognitifs.",
  "Itération des paradigmes fossiles.",
  "Convergence des temporalités."
];

// Initialisation
function layoutSlides() {
  slides.forEach((slide, i) => {
    slide.style.transform = `translateX(${(i - index) * 100}%)`;
  });
}
layoutSlides();

// --- NAVIGATION ---
function next() {
  // Si on est sur une slide normale, on avance
  if (index < slides.length - 1) {
    index++;
    layoutSlides();
  } else {
    // Si on est à la toute fin (normalement c'est une gag-slide active), 
    // on appelle la fonction d'ajout de puce
    let currentSlide = slides[index];
    if (currentSlide.classList.contains('gag-slide') && !currentSlide.classList.contains('frozen')) {
      addBullet(currentSlide);
    }
  }
}

function previous() {
  if (index > 0) {
    index--;
    layoutSlides();
  }
}

// --- LOGIQUE DU GAG (Liste à puces) ---

function addBullet(slideElement) {
  const list = slideElement.querySelector('.bullet-list');
  const text = randomBullets[Math.floor(Math.random() * randomBullets.length)];
  const li = document.createElement('li');
  li.textContent = text;
  list.appendChild(li);
  // Animation fade-in
  requestAnimationFrame(() => { li.style.opacity = 1; });
}

// Fonction appelée par la FLÈCHE HAUT sur une gag-slide
function triggerBatchGeneration(currentSlideElement) {
  // 1. On "gèle" la slide actuelle pour qu'elle ne reçoive plus de puces
  currentSlideElement.classList.add('frozen');
  const list = currentSlideElement.querySelector('.bullet-list');
  if(list) list.style.opacity = 0.5; // Feedback visuel

  // 2. On génère 10 slides normales
  for (let i = 0; i < BATCH_SIZE; i++) {
    createNormalSlide();
  }

  // 3. On génère UNE nouvelle slide "Gag" à la fin pour la prochaine fois
  createGagSlide();

  // 4. On met à jour le tableau des slides
  slides = Array.from(document.querySelectorAll('.slide'));

  // 5. On passe automatiquement à la première slide nouvellement créée
  index++; 
  layoutSlides();
}

// --- GÉNÉRATEURS DE DOM ---

function createNormalSlide() {
  const section = document.createElement('section');
  section.className = 'slide';
  section.style.background = '#111';
  
  // Titre incrémentiel
  const titleNum = globalSlideCounter++;
  
  // Contenu générique
  section.innerHTML = `
    <div class="content-box">
      <h2>Vérification séquentielle</h2>
      <h1>Préhistoire et Anticipation#${titleNum}</h1>
      <h3>Suite et fin</h3>
      <p>Merci pour votre attention..</p>
      <div class="quote-ref">EFRATI B. 2025, Notes de terrain, Besançon.</div>
    </div>
    <span class="image-box" style="background-image:url('${IMG_GITHUB}');"></span>
  `;
  
  document.getElementById('slides').appendChild(section);
}

function createGagSlide() {
  const section = document.createElement('section');
  section.className = 'slide gag-slide'; // Importante classe pour la logique
  section.style.background = '#111';
  
  section.innerHTML = `
    <div class="content-box">
      <h2>Retour de l'Analyse</h2>
      <h1>Points Essentiels (Suite)</h1>
      <ul class="bullet-list"></ul>
      <p style="margin-top:2rem; opacity:0.5; font-size:0.8rem; border-top:1px solid #333; padding-top:0.5rem;">
        → Ajouter point : Flèche Droite / Bas <br>
        ↑ Sortir de la boucle et continuer
      </p>
    </div>
  `;
  
  document.getElementById('slides').appendChild(section);
}

// --- CONTRÔLES CLAVIER ---

window.addEventListener('keydown', e => {
  // Plein écran (F)
  if (e.key.toLowerCase() === 'f') {
    if (!document.fullscreenElement) document.documentElement.requestFullscreen();
    else document.exitFullscreen();
    return;
  }

  const currentSlide = slides[index];
  const isGagSlide = currentSlide.classList.contains('gag-slide');
  const isFrozen = currentSlide.classList.contains('frozen');

  // CAS 1 : On est sur une Slide "Gag" active
  if (isGagSlide && !isFrozen) {
    // Ajouter une puce
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === 'PageDown') {
      addBullet(currentSlide);
      return; 
    }
    // SORTIE DE BOUCLE (Générer la suite)
    if (e.key === 'ArrowUp') {
      triggerBatchGeneration(currentSlide);
      return;
    }
    // Retour en arrière autorisé
    if (e.key === 'ArrowLeft' || e.key === 'PageUp') {
      previous();
      return;
    }
  }

  // CAS 2 : Navigation normale (Slides classiques ou Gag slide gelée)
  if (e.key === 'ArrowRight' || e.key === 'PageDown') next();
  if (e.key === 'ArrowLeft' || e.key === 'PageUp') previous();
});

// Bouton UI Fullscreen
document.getElementById('fullscreenToggle').addEventListener('click', () => {
  if (!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
});

</script>
</body>
</html>
